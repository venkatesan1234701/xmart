<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Edit Address</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- SweetAlert2 -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
  .form-control:focus, .form-select:focus {
    border-color: #0d6efd;
    box-shadow: 0 0 0 0.15rem rgba(13, 110, 253, 0.25);
  }
</style>
</head>
<body class="bg-light">
<!-- 
<div class="container">
  <div class="max-w-lg mx-auto mt-5 bg-white p-5 rounded shadow-sm">
    <h1 class="text-center mb-4">Edit Address</h1>

    <form id="editAddressForm" action="/user/edit-address/<%= address._id %>" method="POST" class="needs-validation" novalidate>

      <div class="mb-3">
        <label for="firstName" class="form-label">First Name</label>
        <input type="text" id="firstName" name="firstName" class="form-control" value="<%= address.firstName %>" required>
        <div class="invalid-feedback">Enter First Name</div>
      </div>

      <div class="mb-3">
        <label for="addressType" class="form-label">Address Type</label>
        <select id="addressType" name="addressType" class="form-select" required>
          <option value="">Select Address Type</option>
          <option value="Home" <%= address.addressType === 'Home' ? 'selected' : '' %>>Home</option>
          <option value="Work" <%= address.addressType === 'Work' ? 'selected' : '' %>>Work</option>
          <option value="Other" <%= address.addressType === 'Other' ? 'selected' : '' %>>Other</option>
        </select>
        <div class="invalid-feedback">Select Address Type</div>
      </div>

      <div class="mb-3">
        <label for="addressLine1" class="form-label">Address Line 1</label>
        <input type="text" id="addressLine1" name="addressLine1" class="form-control" value="<%= address.addressLine1 %>" required>
        <div class="invalid-feedback">Enter Address Line 1</div>
      </div>

      <div class="mb-3">
        <label for="addressLine2" class="form-label">Address Line 2</label>
        <input type="text" id="addressLine2" name="addressLine2" class="form-control" value="<%= address.addressLine2 || '' %>">
      </div>

      <div class="mb-3">
        <label for="city" class="form-label">City</label>
        <input type="text" id="city" name="city" class="form-control" value="<%= address.city %>" required>
        <div class="invalid-feedback">Enter City</div>
      </div>

      <div class="mb-3">
        <label for="state" class="form-label">State</label>
        <input type="text" id="state" name="state" class="form-control" value="<%= address.state %>" required>
        <div class="invalid-feedback">Enter State</div>
      </div>

      <div class="mb-3">
        <label for="country" class="form-label">Country</label>
        <input type="text" id="country" name="country" class="form-control" value="<%= address.country %>" required>
        <div class="invalid-feedback">Enter Country</div>
      </div>

      <div class="mb-3">
        <label for="zipCode" class="form-label">Zip Code</label>
        <input type="text" id="zipCode" name="zipCode" class="form-control" value="<%= address.zipCode %>" required>
        <div class="invalid-feedback">Enter Zip Code</div>
      </div>

      <button type="submit" class="btn btn-primary w-100">Update Address</button>
    </form>
  </div>
</div> -->


<div class="container d-flex justify-content-center">
  <div class="col-lg-6 col-md-8 col-12">

    <div class="card shadow-lg border-0 p-4 mt-5 rounded-4">

      <h2 class="text-center mb-4 fw-bold text-primary">✏️ Edit Address</h2>

      <form id="editAddressForm" action="/user/edit-address/<%= address._id %>" method="POST" class="needs-validation" novalidate>

        <!-- First Name -->
        <div class="mb-3">
          <label class="form-label fw-semibold">First Name</label>
          <input 
            type="text" 
            id="firstName" 
            name="firstName" 
            class="form-control form-control-lg rounded-3"
            value="<%= address.firstName %>"
            required
          >
          <div class="invalid-feedback">Enter First Name</div>
        </div>

        <!-- Address Type -->
        <div class="mb-3">
          <label class="form-label fw-semibold">Address Type</label>
          <select 
            id="addressType" 
            name="addressType" 
            class="form-select form-select-lg rounded-3"
            required
          >
            <option value="">Select Address Type</option>
            <option value="Home" <%= address.addressType === 'Home' ? 'selected' : '' %>>Home</option>
            <option value="Work" <%= address.addressType === 'Work' ? 'selected' : '' %>>Work</option>
            <option value="Other" <%= address.addressType === 'Other' ? 'selected' : '' %>>Other</option>
          </select>
          <div class="invalid-feedback">Select Address Type</div>
        </div>

        <!-- Address Line 1 -->
        <div class="mb-3">
          <label class="form-label fw-semibold">Address Line 1</label>
          <input 
            type="text" 
            id="addressLine1" 
            name="addressLine1" 
            class="form-control form-control-lg rounded-3"
            value="<%= address.addressLine1 %>"
            required
          >
          <div class="invalid-feedback">Enter Address Line 1</div>
        </div>

        <!-- Address Line 2 (Optional) -->
        <div class="mb-3">
          <label class="form-label fw-semibold">Address Line 2 (Optional)</label>
          <input 
            type="text" 
            id="addressLine2" 
            name="addressLine2" 
            class="form-control form-control-lg rounded-3"
            value="<%= address.addressLine2 || '' %>"
          >
        </div>

        <!-- City -->
        <div class="mb-3">
          <label class="form-label fw-semibold">City</label>
          <input 
            type="text" 
            id="city" 
            name="city" 
            class="form-control form-control-lg rounded-3"
            value="<%= address.city %>"
            required
          >
          <div class="invalid-feedback">Enter City</div>
        </div>

        <!-- State -->
        <div class="mb-3">
          <label class="form-label fw-semibold">State</label>
          <input 
            type="text" 
            id="state" 
            name="state" 
            class="form-control form-control-lg rounded-3"
            value="<%= address.state %>"
            required
          >
          <div class="invalid-feedback">Enter State</div>
        </div>

        <!-- Country -->
        <div class="mb-3">
          <label class="form-label fw-semibold">Country</label>
          <input 
            type="text" 
            id="country" 
            name="country" 
            class="form-control form-control-lg rounded-3"
            value="<%= address.country %>"
            required
          >
          <div class="invalid-feedback">Enter Country</div>
        </div>

        <!-- Zip Code -->
        <div class="mb-3">
          <label class="form-label fw-semibold">Zip Code</label>
          <input 
            type="text" 
            id="zipCode" 
            name="zipCode" 
            class="form-control form-control-lg rounded-3"
            value="<%= address.zipCode %>"
            required
            maxlength="6"
            pattern="^[0-9]{6}$"
          >
          <div class="invalid-feedback">Enter valid 6-digit Zip Code</div>
        </div>

        <!-- Submit Button -->
        <button class="btn btn-primary btn-lg w-100 rounded-4 mt-3">
          Update Address
        </button>
         <a href="/profile" class="btn btn-primary btn-lg w-100 mt-2 shadow-sm">
        <i class="bi bi-save2"></i> back
         </a>

      </form>
    </div>

  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
  document.getElementById("zipCode").addEventListener("input", function () {
  this.value = this.value.replace(/\D/g, "").slice(0, 6);
});
  // Bootstrap client-side validation
  (function () {
    'use strict'
    const forms = document.querySelectorAll('.needs-validation')
    Array.from(forms).forEach(function (form) {
      form.addEventListener('submit', function (event) {
        if (!form.checkValidity()) {
          event.preventDefault()
          event.stopPropagation()
        }
        form.classList.add('was-validated')
      }, false)
    })
  })()
</script>

<!-- SweetAlert feedback after server response -->
<% if (success) { %>
<script>
  Swal.fire({
    icon: 'success',
    title: 'Address Updated!',
    text: '<%= success %>',
    timer: 2000,
    showConfirmButton: false
  }).then(() => {
    window.location.href = '/profile';
  });
</script>
<% } %>

<% if (error) { %>
<script>
  Swal.fire({
    icon: 'error',
    title: 'Oops!',
    text: '<%= error %>'
  });
</script>
<% } %>

</body>
</html>
