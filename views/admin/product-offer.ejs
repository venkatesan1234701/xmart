<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Offer </title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../assets/css/theme.min.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <!-- <style>
    /* Buttons Styling */
    .btn-success {
      background: linear-gradient(135deg, #16a34a, #22c55e);
      color: white; font-weight: 600; border: none; border-radius: 8px;
      padding: 8px 20px; transition: all 0.3s ease;
      box-shadow: 0 2px 6px rgba(22, 163, 74, 0.3);
    }
    .btn-success:hover {
      background: linear-gradient(135deg, #15803d, #16a34a);
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(22, 163, 74, 0.4);
    }
    .btn-edit {
      color: #0d6efd; border: 1px solid #0d6efd; background-color: white;
      border-radius: 6px; padding: 5px 12px; transition: all 0.3s ease;
    }
    .btn-edit:hover { background-color: #0d6efd; color: white; box-shadow: 0 2px 8px rgba(13,110,253,0.3);}
    .btn-delete {
      color: #dc3545; border: 1px solid #dc3545; background-color: white;
      border-radius: 6px; padding: 5px 12px; transition: all 0.3s ease;
    }
    .btn-delete:hover { background-color: #dc3545; color: white; box-shadow: 0 2px 8px rgba(220,53,69,0.3);}
  </style> -->

<style>

  /* ==============================================
   GLOBAL PAGE
================================================= */
body {
  background: #f5f7fa;
  font-family: "Inter", sans-serif;
}

/* Page Title */
h2 {
  font-weight: 700;
  color: #1f2937;
}

/* ==============================================
   NAVBAR
================================================= */

.navbar {
  box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  padding: 12px 18px;
}

.nav-link {
  font-weight: 500;
  transition: 0.25s ease;
}

.nav-link:hover {
  color: #16a34a !important;
}

/* ==============================================
   SEARCH BAR
================================================= */
#product-search {
  border-radius: 10px !important;
  border: 1px solid #cbd5e1 !important;
  transition: 0.3s ease;
}

#product-search:focus {
  border-color: #22c55e !important;
  box-shadow: 0 0 6px rgba(34,197,94,0.4);
}

/* Search Button */
button[type="submit"] {
  border-radius: 10px;
  transition: 0.25s ease;
}

button[type="submit"]:hover {
  transform: translateY(-2px);
  background: #059669 !important;
}

/* ==============================================
   TABLE DESIGN
================================================= */
table {
  border-radius: 12px !important;
  overflow: hidden;
}

table thead {
  background: #f3f4f6;
  font-size: 14px;
  letter-spacing: 0.4px;
}

table tbody tr {
  transition: 0.25s ease;
}

table tbody tr:hover {
  background: #f9fafb;
  transform: translateX(3px);
}

table td {
  padding: 14px;
}

/* ==============================================
   BUTTONS
================================================= */
.btn-success {
  background: linear-gradient(135deg, #16a34a, #22c55e);
  border: none;
  border-radius: 8px;
  padding: 8px 20px;
  font-weight: 600;
  color: #fff;
  transition: 0.3s ease;
  box-shadow: 0 2px 6px rgba(22,163,74,0.25);
}

.btn-success:hover {
  background: linear-gradient(135deg, #15803d, #16a34a);
  transform: translateY(-2px);
  box-shadow: 0 4px 10px rgba(16,144,62,0.4);
}

/* Edit Button */
.btn-edit {
  color: #0d6efd;
  border: 1px solid #0d6efd;
  border-radius: 6px;
  padding: 5px 12px;
  background: white;
  transition: 0.25s ease;
}
.btn-edit:hover {
  background: #0d6efd;
  color: white;
  box-shadow: 0 3px 10px rgba(13,110,253,0.3);
  transform: translateY(-2px);
}

/* Delete Button */
.btn-delete {
  color: #dc3545;
  border: 1px solid #dc3545;
  background: white;
  border-radius: 6px;
  padding: 5px 12px;
  transition: 0.25s ease;
}
.btn-delete:hover {
  background: #dc3545;
  color: white;
  box-shadow: 0 3px 10px rgba(220,53,69,0.3);
  transform: translateY(-2px);
}

/* ==============================================
   STATUS BADGE
================================================= */
.badge {
  padding: 6px 12px !important;
  font-size: 12px !important;
  font-weight: 600 !important;
  border-radius: 20px;
}

.bg-success {
  background: #d1fae5 !important;
  color: #15803d !important;
}

.bg-danger {
  background: #fee2e2 !important;
  color: #b91c1c !important;
}

.bg-warning {
  background: #fef9c3 !important;
  color: #c67a04 !important;
}

/* ==============================================
   MODAL DESIGN
================================================= */
.modal-content {
  border-radius: 14px;
  border: none;
  box-shadow: 0 4px 14px rgba(0,0,0,0.15);
}

.modal-header {
  background: #f3f4f6;
  border-radius: 12px 12px 0 0 !important;
}

.modal-title {
  font-weight: 600;
}

.form-control, .form-select {
  border-radius: 8px;
  border: 1px solid #cbd5e1;
  transition: 0.3s ease;
}

.form-control:focus, .form-select:focus {
  border-color: #22c55e;
  box-shadow: 0 0 6px rgba(34,197,94,0.4);
}

/* ==============================================
   PAGINATION
================================================= */
.pagination .page-item .page-link {
  border-radius: 8px !important;
  margin: 0 4px;
  transition: 0.25s ease;
}

.pagination .page-link:hover {
  background: #e5e7eb;
}

.pagination .active .page-link {
  background: #16a34a !important;
  border-color: #16a34a !important;
  color: white !important;
}

/* ==============================================
   RESPONSIVE TABLE (mobile)
================================================= */
@media (max-width: 768px) {
  table thead {
    display: none;
  }

  table tbody tr {
    display: block;
    padding: 12px;
    margin-bottom: 10px;
    border: 1px solid #e5e7eb;
    border-radius: 10px;
  }

  table td {
    display: flex;
    justify-content: space-between;
    padding: 8px 5px;
  }

  table td::before {
    content: attr(data-label);
    font-weight: 600;
    color: #6b7280;
  }
}
@media (max-width: 640px) {
  aside {
    transform: translateX(-100%);
    transition: 0.3s;
  }

  aside.open {
    transform: translateX(0);
  }

  main {
    margin-left: 0 !important;
    width: 100% !important;
  }
}
</style>

</head>
<body class="bg-light">

  <!-- Navbar (shortened for brevity, keep your full navbar here) -->
 

  
<button id="menuBtn"
  class="md:hidden px-3 py-2 bg-green-600 text-white rounded">
  ‚ò∞
</button>



  <aside class="fixed top-0 left-0 h-screen w-64 bg-white shadow-lg z-40">
  
  <!-- Logo -->
  <div class="flex items-center justify-center h-16 border-b">
    <img src="../assets/images/logo/Xe mart.png" class="h-10" />
  </div>

  <!-- Menu -->
  <ul class="flex flex-col gap-2 p-4">

    <li>
      <a href="/admin/dashboard"
         class="flex items-center gap-3 p-2 rounded hover:bg-green-100 text-gray-700">
        üè† <span>Dashboard</span>
      </a>
    </li>

    <li>
      <a href="/admin/products"
         class="flex items-center gap-3 p-2 rounded hover:bg-green-100 text-gray-700">
        üõí <span>Products</span>
      </a>
    </li>

    <li>
      <a href="/admin/categories"
         class="flex items-center gap-3 p-2 rounded hover:bg-green-100 text-gray-700">
        üìÇ <span>Categories</span>
      </a>
    </li>

    <li>
      <a href="/admin/customers"
         class="flex items-center gap-3 p-2 rounded hover:bg-green-100 text-gray-700">
        üë• <span>Customers</span>
      </a>
    </li>

    <li>
      <a href="/admin/orders"
         class="flex items-center gap-3 p-2 rounded hover:bg-green-100 text-gray-700">
        üì¶ <span>Orders</span>
      </a>
    </li>

    <li>
      <a href="/admin/coupons"
         class="flex items-center gap-3 p-2 rounded hover:bg-green-100 text-gray-700">
        üéüÔ∏è <span>Coupons</span>
      </a>
    </li>

    <li>
      <a href="/admin/product-offer"
         class="flex items-center gap-3 p-2 rounded hover:bg-green-100 text-gray-700">
        üí∏ <span>Product Offer</span>
      </a>
    </li>

    <li>
      <a href="/admin/category-offer"
         class="flex items-center gap-3 p-2 rounded hover:bg-green-100 text-gray-700">
        üè∑Ô∏è <span>Category Offer</span>
      </a>
    </li>

    <li>
      <a href="/admin/sales-report"
         class="flex items-center gap-3 p-2 rounded hover:bg-green-100 text-gray-700">
        üìä <span>Sales Report</span>
      </a>
    </li>

    <li class="mt-6">
      <a href="/admin/logout"
         class="flex items-center gap-3 p-2 rounded text-red-600 hover:bg-red-100">
        üö™ <span>Logout</span>
      </a>
    </li>

  </ul>
</aside>


  <main class="pt-6 pt-20 min-h-screen overflow-y-auto"
  style="margin-left:14rem; width:calc(100% - 16rem);">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2 class="fw-semibold text-dark">Product Offers</h2>
      <button class="btn btn-success" id="openModalBtn">+ Add Offer</button>
    </div>

    <!-- Search Form -->
<form action="" method="get" class="flex items-center gap-2 mb-3">
  <input
    name="search"
    id="product-search"
    value="<%= search || '' %>"
    type="search"
    placeholder="Search Product Offer..."
    autocomplete="off"
    class="border border-gray-300 text-gray-900 rounded-md focus:ring-green-600 focus:ring-1 block p-1.5 px-2 w-1/4 text-sm"
  />
  <button
    type="submit"
    class="px-3 py-1.5 bg-green-600 hover:bg-green-700 text-white text-sm rounded-md flex items-center justify-center"
  >
    üîç Search
  </button>
</form>





    <!-- Offers Table -->
    <div class="table-responsive bg-white shadow-sm rounded p-3">
      <table class="table table-bordered table-hover align-middle text-center">
        <thead class="table-light">
          <tr>
            <th>S.No</th>
            <th>Product</th>
            <th>Offer %</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Status</th>
            <th>Edit</th>
            <th>Delete</th>
          </tr>
        </thead>
        <tbody>
          <% if (!offers || offers.length === 0) { %>
            <tr>
              <td colspan="8" class="text-secondary py-4">No Product Offers Found</td>
            </tr>
          <% } else { %>
            <% offers.forEach((o, i) => { %>
              <tr>
                <td><%= i + 1 %></td>
                <td><%= o.product?.name || '-' %></td>
                <td><%= o.offerPercentage %>%</td>
                <td><%= o.startDate?.toISOString().split('T')[0] || '-' %></td>
                <td><%= o.endDate?.toISOString().split('T')[0] || '-' %></td>
                <!-- <td>
                  <span class="badge <% if(o.currentStatus==='active'){ %> bg-success <% } else if(o.currentStatus==='expired'){ %> bg-danger <% } else { %> bg-warning text-dark <% } %>">
                    <%= o.currentStatus %>
                  </span>
                </td> -->

  <td>
      <span class="badge 
        <% if (o.currentStatus === 'active') { %> bg-success 
        <% } else if (o.currentStatus === 'expired') { %> bg-danger 
        <% } else { %> bg-warning text-dark <% } %>">
        <%= o.currentStatus %>
      </span>
    </td>

                <td>
  <button 
    class="btn-edit" 
    data-offer='<%- JSON.stringify(o) %>' 
    onclick="openEditModalFromButton(this)">
    Edit
  </button>
</td>

                <td>
                  <button class="btn-delete" onclick="deleteOffer('<%= o._id %>')">Delete</button>
                </td>
              </tr>
            <% }) %>
          <% } %>
        </tbody>
      </table>
    </div>
  </main>

  <!-- Add/Edit Offer Modal -->
 
<div class="modal fade" id="couponModal" tabindex="-1" aria-labelledby="couponModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content p-3">
      <div class="modal-header">
        <h5 class="modal-title" id="couponModalLabel">Add Product Offer</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="offerForm" class="row g-3">
          <input type="hidden" id="productOfferId">

          <!-- Product selection / display -->
          <div class="col-12">
            <label>Product</label>

            <!-- Dropdown for Add -->
            <select class="form-select" id="productSelect" >
              <option value="">Choose...</option>
              <% products.forEach(p => { %>
                <option value="<%= p._id %>"><%= p.name %></option>
              <% }) %>
            </select>

            <!-- Plain text for Edit -->
            <p id="productNameDisplay" class="form-control d-none"></p>
          </div>

          <div class="col-12">
            <label>Offer %</label>
            <input type="number" class="form-control" id="offerPercentage" min="1" max="100" >
          </div>

          <div class="col-12">
            <label>Start Date</label>
            <input type="date" class="form-control" id="startDate" >
          </div>

          <div class="col-12">
            <label>End Date</label>
            <input type="date" class="form-control" id="endDate" >
          </div>

          <div class="col-12">
            <label>Status</label>
            <select class="form-select" id="currentStatus">
              <option value="list">List</option>
              <option value="unlist">Unlist</option>
            </select>
          </div>

          <div class="col-12 d-flex justify-content-end gap-2 mt-2">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-success">Save</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<nav aria-label="Page navigation example">
  <ul class="pagination justify-content-center mt-3">
    <% for(let i = 1; i <= totalPages; i++) { %>
      <li class="page-item <%= i === currentPage ? 'active' : '' %>">
        <a class="page-link" href="?search=<%= search %>&page=<%= i %>"><%= i %></a>
      </li>
    <% } %>
  </ul>
</nav>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const offerForm = document.getElementById("offerForm");
  const modalEl = document.getElementById("couponModal");
  const offerModal = new bootstrap.Modal(modalEl);
  const productSelect = document.getElementById("productSelect");
  const productNameDisplay = document.getElementById("productNameDisplay");
  const openModalBtn = document.getElementById("openModalBtn");

  // üü¢ OPEN ADD MODAL
  if (openModalBtn) {
    openModalBtn.addEventListener("click", () => {
      offerForm.reset();
      document.getElementById("productOfferId").value = "";
      document.querySelector(".modal-title").innerText = "Add Product Offer";

      // Show dropdown, enable it
      productSelect.classList.remove("d-none");
      productSelect.removeAttribute("disabled");

      // Hide product name display
      productNameDisplay.classList.add("d-none");
      productNameDisplay.innerText = "";

      // Default status
      document.getElementById("currentStatus").value = "list";
      offerModal.show();
    });
  }

  // üü¢ SUBMIT (Add / Edit)
  offerForm.addEventListener("submit", async (e) => {
    e.preventDefault();

    const id = document.getElementById("productOfferId").value;
    const productId = document.getElementById("productSelect").value;
    const offerPercentage = Number(document.getElementById("offerPercentage").value);
    const startDate = document.getElementById("startDate").value;
    const endDate = document.getElementById("endDate").value;
    const status = document.getElementById("currentStatus").value;

    // Validation
    if ((!id && !productId) || !offerPercentage || !startDate || !endDate) {
      return Swal.fire("Validation Error", "All fields are required", "warning");
    }

    if (new Date(endDate) <= new Date(startDate)) {
      return Swal.fire("Validation Error", "End date must be after start date", "warning");
    }

    // prepare payload
    const payload = {
      offerPercentage,
      startDate,
      endDate,
      isListed: status === "list",
    };

    if (!id) payload.productId = productId; // only add productId in ADD mode
    else payload.productOfferId = id; // send ID in update mode

    // ‚úÖ FIXED ROUTES (as per your backend)
    const url = id
      ? `/admin/productOffers/updateOffer`
      : `/admin/productOffers/addOffer`;
    const method = id ? "PUT" : "POST";

    try {
      const res = await fetch(url, {
        method,
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload),
      });

      const data = await res.json();

      if (res.ok) {
        Swal.fire("Success", data.message || "Offer saved successfully!", "success")
          .then(() => location.reload());
      } else {
        Swal.fire("Error", data.error || "Something went wrong", "error");
      }
    } catch (err) {
      console.error("Error saving product offer:", err);
      Swal.fire("Error", "Server request failed", "error");
    }
  });
});

// üü° OPEN EDIT MODAL
function openEditModalFromButton(btn) {
  try {
    const offer = JSON.parse(btn.dataset.offer);

    document.getElementById("productOfferId").value = offer._id;
    document.getElementById("offerPercentage").value = offer.offerPercentage;
    document.getElementById("startDate").value = offer.startDate.split("T")[0];
    document.getElementById("endDate").value = offer.endDate.split("T")[0];
    document.getElementById("currentStatus").value = offer.isListed ? "list" : "unlist";
    document.querySelector(".modal-title").innerText = "Edit Product Offer";

    // üü† Hide dropdown, disable it
    const productSelect = document.getElementById("productSelect");
    const productNameDisplay = document.getElementById("productNameDisplay");

    productSelect.classList.add("d-none");
    productSelect.setAttribute("disabled", true);

    productNameDisplay.classList.remove("d-none");
    productNameDisplay.innerText =
      offer.product?.name || offer.productName || "Unknown Product";

    const modalEl = document.getElementById("couponModal");
    const offerModal = new bootstrap.Modal(modalEl);
    offerModal.show();
  } catch (err) {
    console.error("Error opening edit modal:", err);
    Swal.fire("Error", "Unable to open edit modal", "error");
  }
}

// üî¥ DELETE PRODUCT OFFER
async function deleteProductOffer(id) {
  const confirmDelete = await Swal.fire({
    title: "Are you sure?",
    text: "This product offer will be permanently deleted.",
    icon: "warning",
    showCancelButton: true,
    confirmButtonText: "Yes, delete it!",
  });

  if (!confirmDelete.isConfirmed) return;

  try {
    const res = await fetch(`/admin/productOffers/delete/${id}`, {
      method: "DELETE",
    });
    const data = await res.json();

    if (res.ok) {
      Swal.fire({
        title: "Deleted!",
        text: data.message,
        icon: "success",
        timer: 1500,
        showConfirmButton: false,
      });
      setTimeout(() => location.reload(), 1500);
    } else {
      Swal.fire("Error", data.error || "Something went wrong", "error");
    }
  } catch (err) {
    console.error("Error deleting product offer:", err);
    Swal.fire("Error", "Server request failed", "error");
  }
}
</script> -->

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const offerForm = document.getElementById("offerForm");
  const modalEl = document.getElementById("couponModal");
  const offerModal = new bootstrap.Modal(modalEl);
  const productSelect = document.getElementById("productSelect");
  const productNameDisplay = document.getElementById("productNameDisplay");
  const openModalBtn = document.getElementById("openModalBtn");

  // üü¢ OPEN ADD MODAL
  if (openModalBtn) {
    openModalBtn.addEventListener("click", () => {
      offerForm.reset();
      document.getElementById("productOfferId").value = "";
      document.querySelector(".modal-title").innerText = "Add Product Offer";

      productSelect.classList.remove("d-none");
      productSelect.removeAttribute("disabled");
      productNameDisplay.classList.add("d-none");
      productNameDisplay.innerText = "";

      document.getElementById("currentStatus").value = "list";
      offerModal.show();
    });
  }

  // üü¢ SUBMIT (Add / Edit)
  offerForm.addEventListener("submit", async (e) => {
    e.preventDefault();

    const id = document.getElementById("productOfferId").value;
    const productId = document.getElementById("productSelect").value;
    const offerPercentage = Number(document.getElementById("offerPercentage").value);
    const startDate = document.getElementById("startDate").value;
    const endDate = document.getElementById("endDate").value;
    const status = document.getElementById("currentStatus").value;

    // ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
    // ‚≠ê FIELD-WISE VALIDATION ADDED ‚≠ê
    // ‚≠ê NOTHING ELSE CHANGED ‚≠ê

    // Product validation (Only for ADD mode)
    if (!id && !productId) {
      return Swal.fire("Validation Error", "Please select a product", "warning");
    }

    // Offer % validation
    if (!offerPercentage) {
      return Swal.fire("Validation Error", "Offer percentage is required", "warning");
    }
    if (offerPercentage < 1 || offerPercentage > 100) {
      return Swal.fire("Validation Error", "Offer % must be between 1 and 100", "warning");
    }

    // Start date
    if (!startDate) {
      return Swal.fire("Validation Error", "Start date is required", "warning");
    }

    // End date
    if (!endDate) {
      return Swal.fire("Validation Error", "End date is required", "warning");
    }

    // Date order check
    if (new Date(endDate) <= new Date(startDate)) {
      return Swal.fire("Validation Error", "End date must be after start date", "warning");
    }

    // Status validation
    if (!status) {
      return Swal.fire("Validation Error", "Please select a status", "warning");
    }

    // ‚≠ê END OF VALIDATION ‚≠ê
    // ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê


    // prepare payload
    const payload = {
      offerPercentage,
      startDate,
      endDate,
      isListed: status === "list",
    };

    if (!id) payload.productId = productId;
    else payload.productOfferId = id;

    const url = id
      ? `/admin/productOffers/updateOffer`
      : `/admin/productOffers/addOffer`;
    const method = id ? "PUT" : "POST";

    try {
      const res = await fetch(url, {
        method,
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload),
      });

      const data = await res.json();

      if (res.ok) {
        Swal.fire("Success", data.message || "Offer saved successfully!", "success")
          .then(() => location.reload());
      } else {
        Swal.fire("Error", data.error || "Something went wrong", "error");
      }
    } catch (err) {
      console.error("Error saving product offer:", err);
      Swal.fire("Error", "Server request failed", "error");
    }
  });
});

// üü° OPEN EDIT MODAL
function openEditModalFromButton(btn) {
  try {
    const offer = JSON.parse(btn.dataset.offer);

    document.getElementById("productOfferId").value = offer._id;
    document.getElementById("offerPercentage").value = offer.offerPercentage;
    document.getElementById("startDate").value = offer.startDate.split("T")[0];
    document.getElementById("endDate").value = offer.endDate.split("T")[0];
    document.getElementById("currentStatus").value = offer.isListed ? "list" : "unlist";
    document.querySelector(".modal-title").innerText = "Edit Product Offer";

    const productSelect = document.getElementById("productSelect");
    const productNameDisplay = document.getElementById("productNameDisplay");

    productSelect.classList.add("d-none");
    productSelect.setAttribute("disabled", true);

    productNameDisplay.classList.remove("d-none");
    productNameDisplay.innerText =
      offer.product?.name || offer.productName || "Unknown Product";

    const modalEl = document.getElementById("couponModal");
    const offerModal = new bootstrap.Modal(modalEl);
    offerModal.show();
  } catch (err) {
    console.error("Error opening edit modal:", err);
    Swal.fire("Error", "Unable to open edit modal", "error");
  }
}



const menuBtn = document.getElementById("menuBtn");
const sidebar = document.querySelector("aside");

menuBtn.onclick = () => {
  sidebar.classList.toggle("open");
}


async function deleteOffer(id) {

  console.log("Delete clicked:", id); // Debug to check button click

  const confirmDelete = await Swal.fire({
    title: "Are you sure?",
    text: "This product offer will be permanently deleted.",
    icon: "warning",
    showCancelButton: true,
    confirmButtonText: "Yes, delete it!"
  });

  if (!confirmDelete.isConfirmed) return;

  try {

    const res = await fetch(`/admin/productOffers/delete/${id}`, {
      method: "DELETE",
      headers: { "Content-Type": "application/json" }
    });

    const data = await res.json();

    if (res.ok) {
      Swal.fire("Deleted!", data.message || "Offer deleted successfully!", "success")
        .then(() => location.reload());
    } else {
      Swal.fire("Error", data.error || "Unable to delete offer", "error");
    }

  } catch (err) {
    console.error("Delete Offer Error:", err);
    Swal.fire("Error", "Server request failed", "error");
  }
}


</script>



</body>
</html>
